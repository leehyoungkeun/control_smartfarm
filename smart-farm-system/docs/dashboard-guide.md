# 스마트팜 대시보드 운영 가이드

> 이 문서는 스마트팜 시스템을 처음 사용하는 운영자를 위한 안내서입니다.
> 화면의 모든 요소를 하나씩 설명하고, 실제 운영 방법을 단계별로 안내합니다.

---

## 목차

1. [접속 방법](#1-접속-방법)
2. [로그인](#2-로그인)
3. [대시보드 화면 구성](#3-대시보드-화면-구성)
4. [일상 운영 방법](#4-일상-운영-방법)
5. [설정 변경 방법](#5-설정-변경-방법)
6. [경보 대응 방법](#6-경보-대응-방법)
7. [관리자 기능 (원격 모드 전용)](#7-관리자-기능-원격-모드-전용)
8. [자주 묻는 질문](#8-자주-묻는-질문)

---

## 1. 접속 방법

이 시스템은 **두 가지 방법**으로 접속할 수 있습니다.

### 터치패널 (농장 현장)

비닐하우스 안에 설치된 7인치 터치 화면에서 직접 조작합니다.

| 항목 | 내용 |
|------|------|
| 접속 주소 | `http://localhost:3001` 또는 `http://RPi의IP:3001` |
| 모드 | 로컬 모드 (인터넷 없이도 작동) |
| 첫 화면 | 로그인 → 바로 대시보드 |
| 특징 | 농장 1곳만 관리, 관리자 메뉴 없음 |

### PC/노트북 (사무실 원격)

사무실에서 웹 브라우저로 여러 농장을 원격 관리합니다.

| 항목 | 내용 |
|------|------|
| 접속 주소 | `http://사무실서버IP` (Docker 배포 시) 또는 `http://localhost:5173` (개발) |
| 모드 | 원격 모드 (인터넷 필요) |
| 첫 화면 | 로그인 → 농장 선택 → 대시보드 |
| 특징 | 여러 농장 관리 가능, 관리자 메뉴 있음 |

---

## 2. 로그인

### 로컬 모드 (터치패널)

```
┌─────────────────────────┐
│       스마트팜 로그인       │
│                         │
│  사용자명: [admin      ]  │
│  비밀번호: [••••••••   ]  │
│                         │
│     [    로그인    ]      │
└─────────────────────────┘
```

- **기본 계정**: `admin` / `admin1234`
- 사용자명과 비밀번호를 입력하고 "로그인" 버튼을 터치합니다

### 원격 모드 (사무실 PC)

```
┌─────────────────────────┐
│       스마트팜 로그인       │
│                         │
│  이메일:  [user@co.kr  ]  │
│  비밀번호: [••••••••   ]  │
│                         │
│     [    로그인    ]      │
└─────────────────────────┘
```

- 관리자가 등록한 **이메일**과 비밀번호로 로그인합니다
- 로그인 후 접근 가능한 농장 목록이 카드 형태로 표시됩니다
- 원하는 농장 카드를 클릭하면 대시보드로 이동합니다

---

## 3. 대시보드 화면 구성

대시보드는 **1024×600px** 크기의 터치패널에 최적화되어 있으며, 스크롤 없이 모든 정보를 한 화면에 보여줍니다.

### 전체 레이아웃

```
┌────────────────────────────────────────────────────┐
│ ⚠ 경보 배너 (경보 있을 때만 표시)              28px │ ← ①
├────────────────────────────────────────────────────┤
│ ← 농장명    ⚙ 📋 🔒 🔧 📊 🔔 ⌨ ↩   시각 🟢 36px │ ← ②
├────────┬───────────────────────────────────────────┤
│        │  [A][B][C][D][E][F][H]                    │ ← ③
│ 상태   ├───────────────────────────────────────────┤
│ 패널   │  원수→P1→시스템믹싱→P2→[밸브01~14]         │ ← ④
│        │  현재EC | 현재pH | 퇴수EC | 퇴수pH | ...  │ ← ⑤
│ 180px  ├───────────────────────────────────────────┤
│        │  구분 | P1 | P2 | P3 | P4 | P5 | P6      │ ← ⑥
│        │  설정 |  0 |  0 |  0 |  0 |  0 |  0      │
│        │  적산 |  0 |  0 |  0 |  0 |  0 |  0      │
├────────┴───────────────────────────────────────────┤
│  [🔴 비상정지]    [▶ 동작]     [🔧 수동동작]   50px │ ← ⑦
└────────────────────────────────────────────────────┘
```

각 영역을 아래에서 상세히 설명합니다.

---

### ① 경보 배너 (맨 위, 빨간색)

```
┌────────────────────────────────────────────────────┐
│   경보 2건: EC_LOW: 측정값 0.54, 임계값 1           │
└────────────────────────────────────────────────────┘
```

- **언제 나타나나?**: 센서 값이 설정된 안전 범위를 벗어났을 때
- **경보가 없으면**: 이 영역 자체가 사라져서 공간을 차지하지 않습니다
- **빨간색 깜빡임**: 1초 간격으로 깜빡여서 시각적 주의를 끕니다

#### 경보 종류 6가지

| 경보 코드 | 한국어 의미 | 발생 조건 |
|----------|-----------|----------|
| `EC_HIGH` | EC 상한 초과 | EC가 설정값보다 너무 높을 때 |
| `EC_LOW` | EC 하한 미달 | EC가 설정값보다 너무 낮을 때 |
| `PH_HIGH` | pH 상한 초과 | pH가 너무 높을 때 (알칼리성) |
| `PH_LOW` | pH 하한 미달 | pH가 너무 낮을 때 (산성) |
| `TEMP_HIGH` | 온도 상한 초과 | 실내 온도 40°C 초과 |
| `TEMP_LOW` | 온도 하한 미달 | 실내 온도 5°C 미만 |

- **같은 종류 경보는 1건으로 표시**됩니다 (중복 누적 없음)
- 센서 값이 정상 범위로 돌아오면 경보가 **자동으로 해소**됩니다

---

### ② 헤더 바 (농장명 + 메뉴 아이콘 + 시계)

```
← (주)흥농팜온실    ⚙  📋  🔒  🔧  📊  🔔  ⌨  ↩    18:14:08 🟢
```

#### 왼쪽 영역

| 요소 | 설명 |
|------|------|
| `←` 뒤로가기 | 농장 선택 화면으로 돌아갑니다 (원격 모드에서만 표시) |
| 농장명 | 현재 보고 있는 농장 이름 |

#### 가운데 메뉴 아이콘 (8개)

| 순서 | 아이콘 | 이름 | 이동 페이지 | 설명 |
|------|--------|------|-----------|------|
| 1 | ⚙ | 설정 | `/settings` | EC/pH 임계값, 프로그램 ON/OFF 설정 |
| 2 | 📋 | 프로그램 | `/program/1` | 관수 프로그램 상세 설정 |
| 3 | 🔒 | 잠금 | (팝업) | 비밀번호 변경 다이얼로그 |
| 4 | 🔧 | 수동제어 | `/manual` | 밸브/펌프 개별 ON/OFF |
| 5 | 📊 | 일일집계 | `/daily-summary` | 날짜별 관수 실적 조회 |
| 6 | 🔔 | 경보 | `/alarms` | 경보 발생 이력 목록 |
| 7 | ⌨ | 교정 | (미구현) | 센서 교정 (향후 추가 예정) |
| 8 | ↩ | 리셋 | (미구현) | 시스템 리셋 (향후 추가 예정) |

#### 오른쪽 영역

| 요소 | 설명 |
|------|------|
| `18:14:08` | 현재 시각 (1초마다 자동 갱신) |
| 🟢 초록 점 | WebSocket 연결 상태. **초록**=정상 연결, **빨강**=연결 끊김 |

> 빨간 점이 표시되면 3초마다 자동으로 재연결을 시도합니다.

---

### ③ 탱크 시각화 (상단 오른쪽, 80px)

```
  ┌───┐  ┌───┐  ┌───┐  ┌───┐  ┌───┐  ┌───┐  ┌───┐
  │0% │  │0% │  │0% │  │0% │  │0% │  │0% │  │0% │
  │   │  │   │  │   │  │   │  │   │  │   │  │   │
  └───┘  └───┘  └───┘  └───┘  └───┘  └───┘  └───┘
    A      B      C      D      E      F      H
```

7개의 사다리꼴 모양 탱크가 수위를 시각적으로 보여줍니다.

| 탱크 | 용도 | 색상 |
|------|------|------|
| A~F | 양액 원액 탱크 (6종류 영양분) | 파란색 |
| H | 산(Acid) 탱크 (pH 조절용) | 초록색 |

- **0%**: 비어있음 → **100%**: 가득 참
- 탱크에 파란색(또는 초록색)이 아래에서 위로 차오르는 형태로 표시됩니다
- 양액 보충이 필요한 시점을 한눈에 파악할 수 있습니다

---

### ④ 배관도 (가운데, 200px)

시스템의 물리적 배관 구조를 그래픽으로 보여줍니다.

```
  ┌────┐         ┌────────┐         ┌──┬──┬──┬──┬──┬──┬──┐
  │원수│──→(P1)──→│시스템   │──→(P2)──→│01│02│03│04│05│06│07│
  └────┘         │ 믹싱   │         ├──┼──┼──┼──┼──┼──┼──┤
                 └────────┘         │08│09│10│11│12│13│14│
                                    └──┴──┴──┴──┴──┴──┴──┘
```

#### 각 요소 설명

| 요소 | 모양 | 설명 |
|------|------|------|
| **원수** | 파란색 사각형 | 깨끗한 물 저장 탱크 |
| **P1** (원수 펌프) | 회색 원 | 원수를 혼합 탱크로 보내는 펌프 |
| **시스템 믹싱** | 초록색 사각형 | 양액을 혼합하는 탱크 |
| **P2** (관수 펌프) | 회색 원 | 혼합된 양액을 밸브로 보내는 펌프 |
| **01~14** | 사각형 14개 | 각 구역의 관수 밸브 |

#### 색상으로 상태 파악

| 대상 | 회색 | 파란색/초록색 |
|------|------|-------------|
| 펌프 (P1, P2) | 정지 | 가동 중 |
| 밸브 (01~14) | 닫힘 | 열림 (관수 중) |
| 파이프 라인 | 정지 | 점선 애니메이션 (물 흐름 표현) |

> 펌프가 작동하면 파이프에 **점선이 흐르는 애니메이션**이 표시되어 물의 흐름을 직관적으로 확인할 수 있습니다.

---

### ⑤ 센서값 표시 (배관도 아래, 6칸)

```
┌─────────┬─────────┬─────────┬─────────┬───────────┬───────────┐
│  현재EC  │  현재pH  │  퇴수EC  │  퇴수pH  │ 1회관수시간 │ 1회관수유량 │
│   1.2   │   6.1   │   0.8   │   6.3   │   05:30   │   12.5 L  │
└─────────┴─────────┴─────────┴─────────┴───────────┴───────────┘
```

| 항목 | 단위 | 정상 범위 | 의미 |
|------|------|----------|------|
| 현재EC | mS/cm | 1.0~3.0 | 양액의 농도. 높을수록 영양분이 많음 |
| 현재pH | - | 5.5~6.5 | 산성도. 낮으면 산성, 높으면 알칼리 |
| 퇴수EC | mS/cm | - | 식물을 통과한 배출수의 EC |
| 퇴수pH | - | - | 배출수의 pH |
| 1회관수시간 | HH:MM | - | 가장 최근 관수에 걸린 시간 |
| 1회관수유량 | L | - | 가장 최근 관수에 사용된 물량 |

> **EC/pH 값이 빨간색으로 깜빡이면**: 해당 값이 정상 범위를 벗어났다는 경고입니다.

---

### ⑥ 일사량 테이블 (하단, 110px)

```
┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐
│ 구분  │  P1  │  P2  │  P3  │  P4  │  P5  │  P6  │
├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
│ 설정  │ 300  │  0   │  0   │  0   │  0   │  0   │  ← 트리거 목표값
│ 적산  │ 215  │  0   │  0   │  0   │  0   │  0   │  ← 현재 누적값
└──────┴──────┴──────┴──────┴──────┴──────┴──────┘
```

| 행 | 의미 |
|----|------|
| **설정** | 일사량 트리거 목표값 (W/m² 적산). 이 값에 도달하면 자동 관수 시작 |
| **적산** | 현재까지 누적된 일사량. 실시간으로 증가 |

- **적산 ≥ 설정** 이 되면 해당 프로그램의 자동 관수가 시작됩니다
- 관수가 완료되면 적산값이 0으로 리셋됩니다
- 현재 실행 중인 프로그램의 열은 **하늘색 배경**으로 강조 표시됩니다
- 설정값이 0인 프로그램은 일사량 트리거가 비활성 상태입니다

---

### ⑦ 하단 제어 버튼 (3개, 50px)

```
┌──────────────────┬──────────────────┬──────────────────┐
│     비상정지       │       동작       │     수동동작      │
│    (빨간색)        │     (초록색)      │     (파란색)      │
└──────────────────┴──────────────────┴──────────────────┘
```

| 버튼 | 색상 | 동작 | 확인 절차 |
|------|------|------|----------|
| **비상정지** | 🔴 빨간색 | 모든 밸브 닫힘 + 모든 펌프 OFF + 교반기 OFF | 확인 팝업이 뜸. "확인"을 눌러야 실행 |
| **동작** | 🟢 초록색 | 시스템을 RUNNING(동작) 상태로 전환 | 바로 실행 |
| **수동동작** | 🔵 파란색 | 수동 제어 페이지로 이동 | 페이지 이동만 |

> **비상정지 버튼은 가장 중요한 버튼입니다.** 이상 상황이 발생하면 즉시 눌러주세요. 모든 장비가 즉시 멈춥니다.

---

### 왼쪽 상태 패널 (180px)

대시보드 왼쪽에 세로로 배치된 12개 상태 항목입니다.

```
작동프로그램     0
작동상태        정지
작동관수밸브     00
양액공급밸브     정지
원수공급펌프     정지
관수공급펌프     정지
양액교반기      정지
1일관수유량     0.0 L
1일퇴수유량     0.0 L
현재일사량      0 W/m²
내부온도       0.0 °C
원수온도       0.0 °C
```

| 항목 | 표시 예시 | 의미 |
|------|----------|------|
| 작동프로그램 | `0` / `1`~`6` | 현재 실행 중인 관수 프로그램 번호 (0=없음) |
| 작동상태 | `정지` / `동작` / `비상` | 시스템 운전 상태 |
| 작동관수밸브 | `00` / `03` | 현재 열려있는 밸브 번호 (00=없음) |
| 양액공급밸브 | `정지` / `동작` | 양액 공급 밸브 ON/OFF |
| 원수공급펌프 | `정지` / `동작` | P1 펌프 (원수 → 혼합탱크) |
| 관수공급펌프 | `정지` / `동작` | P2 펌프 (혼합탱크 → 밸브) |
| 양액교반기 | `정지` / `동작` | 양액 탱크 내 교반기 모터 |
| 1일관수유량 | `125.3 L` | 오늘 하루 총 공급한 양액량 |
| 1일퇴수유량 | `98.7 L` | 오늘 하루 총 배출(퇴수)량 |
| 현재일사량 | `450 W/m²` | 현재 태양 일사량 |
| 내부온도 | `25.3 °C` | 비닐하우스 내부 온도 |
| 원수온도 | `18.5 °C` | 원수(깨끗한 물) 온도 |

#### 작동상태 색상

| 상태 | 색상 | 의미 |
|------|------|------|
| 정지 (STOPPED) | 회색 | 시스템이 대기 중 |
| 동작 (RUNNING) | 초록색 | 자동 관수가 가능한 상태 |
| 비상 (EMERGENCY) | 빨간색 깜빡임 | 비상정지가 작동된 상태 |

---

## 4. 일상 운영 방법

### 아침: 시스템 시작하기

```
① 대시보드 접속 (로그인)
                ↓
② 왼쪽 패널에서 "작동상태: 정지" 확인
                ↓
③ 하단 [▶ 동작] 버튼 클릭
                ↓
④ 작동상태가 "정지" → "동작"으로 변경됨
                ↓
⑤ 이제부터 Node-RED가 10초마다 트리거 조건을 확인
   (일사량/시간간격/스케줄에 따라 자동 관수 실행)
```

### 낮 동안: 모니터링

자동 관수가 실행되면 대시보드에서 다음과 같이 확인할 수 있습니다:

```
관수 시작 시:                       관수 완료 시:
┌──────────────────────┐          ┌──────────────────────┐
│ 작동프로그램: 1       │          │ 작동프로그램: 0       │
│ 작동상태: 동작        │          │ 작동상태: 동작        │
│ 작동관수밸브: 03      │  ────→   │ 작동관수밸브: 00      │
│ 관수공급펌프: 동작     │          │ 관수공급펌프: 정지     │
└──────────────────────┘          └──────────────────────┘
     배관도에서 V03 초록색              배관도에서 전부 회색
     파이프에 물 흐름 표시              물 흐름 없음
```

### 자동 관수 5단계 시퀀스

자동 관수가 시작되면 아래 5단계가 자동으로 진행됩니다:

| 단계 | 장비 | 설명 | 소요 시간 |
|------|------|------|----------|
| ① 원수 펌프 ON | P1 가동 | 깨끗한 물을 혼합 탱크로 공급 | 약 3초 |
| ② 양액 혼합 | 교반기 ON | 탱크 A~F의 원액을 섞어 목표 EC/pH까지 혼합 | 설정에 따라 다름 |
| ③ 관수 펌프 ON | P2 가동 | 혼합된 양액을 밸브로 보낼 준비 | 약 1초 |
| ④ 밸브 순차 개방 | V01~V14 | 프로그램에 설정된 밸브를 순서대로 열기 | 밸브당 설정 시간 |
| ⑤ 완료 | 전체 OFF | 모든 밸브 닫힘, 펌프 OFF, 실적 기록 | 즉시 |

> 각 단계가 진행될 때마다 왼쪽 상태 패널과 배관도가 실시간으로 업데이트됩니다.

### 저녁: 시스템 정지 (선택)

밤에 관수가 필요 없다면:
1. 하단 **[▶ 동작]** 버튼 대신... 시스템을 그냥 두면 됩니다
2. 트리거 조건(일사량=0)이 충족되지 않으므로 자동 관수가 실행되지 않습니다
3. 명시적으로 정지하려면: 이미 관수 중이 아닌 상태에서는 별도 조작 불필요

### 매일 자정: 자동 집계

- **00:00** — Node-RED가 하루 실적을 자동 집계합니다
- **00:05** — 집계 결과를 클라우드 서버로 자동 전송합니다
- 운영자가 별도로 할 일은 없습니다

---

## 5. 설정 변경 방법

### 환경 설정 (⚙ 아이콘)

헤더의 ⚙ 아이콘을 클릭하면 설정 페이지로 이동합니다.

#### 프로그램 사용 설정

6개 프로그램(P1~P6)의 활성/비활성을 토글합니다.

```
[P1 ✅]  [P2 ✅]  [P3 ❌]  [P4 ❌]  [P5 ❌]  [P6 ❌]
```

- ✅ = 사용 / ❌ = 미사용

#### 기능 설정

| 항목 | 설명 |
|------|------|
| 자동 양액 공급 | ON: 양액 자동 혼합 / OFF: 수동 혼합 |
| 벌크 EC/pH | 대량 급액 시 기준값 |
| 정밀 EC/pH | 정밀 급액 시 기준값 |

#### 환경 설정 (경보 임계값)

| 항목 | 기본값 | 설명 |
|------|--------|------|
| EC 경보 상한 | 3.5 | 이 값 초과 시 EC_HIGH 경보 |
| EC 경보 하한 | 0.3 | 이 값 미만 시 EC_LOW 경보 |
| pH 경보 상한 | 8.5 | 이 값 초과 시 PH_HIGH 경보 |
| pH 경보 하한 | 4.5 | 이 값 미만 시 PH_LOW 경보 |
| 온도 경보 상한 | 40°C | 이 값 초과 시 TEMP_HIGH 경보 |
| 온도 경보 하한 | 5°C | 이 값 미만 시 TEMP_LOW 경보 |

> 설정을 변경하고 "저장" 버튼을 누르면, MQTT를 통해 RPi에 자동으로 전달됩니다.

### 프로그램 상세 설정 (📋 아이콘)

#### 트리거 설정 (관수 시작 조건)

3가지 트리거 중 하나 이상을 활성화합니다:

| 트리거 | 설명 | 설정 예시 |
|--------|------|----------|
| **일사량** | 누적 일사량이 설정값에 도달하면 관수 시작 | 300 W/m² |
| **시간간격** | 마지막 관수 후 설정 시간이 지나면 관수 시작 | 120분 |
| **고정시간** | 특정 시각에 관수 시작 (최대 9개 시간 설정 가능) | 09:00, 13:00, 17:00 |

#### 밸브 설정 (14개)

각 밸브별로 개별 설정합니다:

```
┌──────┬──────────┬───────────┬──────────────┐
│ 밸브  │ 활성화    │ 시간(초)   │ 또는 유량(L)  │
├──────┼──────────┼───────────┼──────────────┤
│ V01  │    ✅    │   120     │     -        │
│ V02  │    ✅    │   120     │     -        │
│ V03  │    ❌    │    -      │     -        │
│ ...  │   ...    │   ...     │    ...       │
│ V14  │    ❌    │    -      │     -        │
└──────┴──────────┴───────────┴──────────────┘
```

- **시간 모드**: 설정한 초(秒) 동안 밸브 열기
- **유량 모드**: 설정한 리터(L)만큼 공급 후 밸브 닫기

#### 양액 설정

| 항목 | 설명 |
|------|------|
| 목표 EC | 이 EC값이 될 때까지 양액 혼합 |
| 목표 pH | 이 pH값이 될 때까지 산/알칼리 투입 |
| 탱크 비율 (A~F, 산) | 각 탱크의 원액 혼합 비율 |

#### 요일 설정

```
[일 ✅] [월 ✅] [화 ✅] [수 ✅] [목 ✅] [금 ✅] [토 ✅]
```

선택한 요일에만 자동 관수가 실행됩니다.

---

## 6. 경보 대응 방법

### 경보가 발생하면

1. **대시보드 상단에 빨간 배너**가 나타납니다
2. **경보 내용을 확인**합니다 (어떤 센서가 어떤 값인지)
3. **상황에 따라 조치**합니다:

| 경보 | 원인 | 조치 방법 |
|------|------|----------|
| EC_HIGH | 양액 농도가 너무 높음 | 원수를 추가하여 희석 / 혼합 비율 조정 |
| EC_LOW | 양액 농도가 너무 낮음 | 양액 원액 보충 / 탱크 수위 확인 |
| PH_HIGH | pH가 너무 높음 | 산(Acid) 탱크 확인 / 산 투입량 증가 |
| PH_LOW | pH가 너무 낮음 | 알칼리 투입 / 산 투입량 감소 |
| TEMP_HIGH | 하우스 온도가 너무 높음 | 환기 시스템 가동 / 차광막 설치 |
| TEMP_LOW | 하우스 온도가 너무 낮음 | 난방 가동 |

### 경보 이력 확인

1. 헤더의 🔔 아이콘 클릭
2. 경보 목록이 표시됩니다:

```
┌───────────────┬──────────┬────────┬────────┬───────────────┬──────────┐
│   발생 시각    │   유형    │ 측정값  │ 임계값  │   해소 시각    │   메시지  │
├───────────────┼──────────┼────────┼────────┼───────────────┼──────────┤
│ 2026-02-15    │ EC_LOW   │  0.54  │  1.0   │ 2026-02-15    │ EC 하한  │
│ 18:10:00      │          │        │        │ 18:15:00      │ 미달     │
├───────────────┼──────────┼────────┼────────┼───────────────┼──────────┤
│ 2026-02-15    │ TEMP_HIGH│  42.3  │  40.0  │     -         │ 온도 상한│
│ 14:30:00      │          │        │        │  (미해소)      │ 초과     │
└───────────────┴──────────┴────────┴────────┴───────────────┴──────────┘
```

- **빨간 배경**: 아직 해소되지 않은 경보
- **해소 시각이 있으면**: 센서가 정상 범위로 돌아와서 자동 해소된 경보

---

## 7. 관리자 기능 (원격 모드 전용)

원격 모드에서 `admin` 이상 권한을 가진 사용자만 접근할 수 있는 메뉴입니다.

### 시스템 현황 (`/admin/overview`)

```
┌──────────┬──────────┬──────────┬──────────┐
│ 전체 농장  │ 온라인   │ 오프라인   │ 활성 경보  │
│    12    │    10    │    2     │    3     │
└──────────┴──────────┴──────────┴──────────┘

7일간 경보 추이 [막대 차트]
```

- 전체 농장 현황을 한눈에 파악
- 오프라인 농장 목록과 마지막 접속 시간 표시
- 7일간 경보 발생 추이를 차트로 확인

### 사용자 관리 (`/admin/users`)

| 기능 | 설명 |
|------|------|
| 사용자 목록 | 이름, 이메일, 역할, 접근 농장 수, 최종 로그인 |
| 사용자 추가 | 이름, 이메일, 비밀번호, 역할 지정 |
| 농장 권한 설정 | 사용자별로 접근 가능한 농장과 권한(제어/조회) 설정 |
| 사용자 비활성화 | 계정을 비활성 상태로 전환 |

#### 역할 체계

| 역할 | 설명 | 색상 |
|------|------|------|
| **superadmin** | 전체 시스템 관리 | 빨간색 |
| **admin** | 소속 조직 관리 (사용자, 농장) | 파란색 |
| **operator** | 담당 농장 제어 가능 | 초록색 |
| **viewer** | 조회만 가능, 제어 불가 | 회색 |

### 농장 관리 (`/admin/farms`)

| 기능 | 설명 |
|------|------|
| 농장 목록 | 이름, 위치, Thing Name, 상태, 최종 연결 |
| 농장 추가 | 이름, 위치, AWS Thing Name, MQTT 토픽 설정 |
| 농장 수정 | 정보 변경 |
| 농장 비활성화 | 상태를 inactive로 전환 |
| 농장 상세 보기 | 해당 농장의 대시보드로 이동 |

#### 농장 상태

| 상태 | 색상 | 의미 |
|------|------|------|
| active | 초록색 | 정상 운영 중 |
| inactive | 회색 | 운영 중지 (데이터 보존) |
| maintenance | 주황색 | 유지보수 중 |

### 경보 센터 (`/admin/alarms`)

- 모든 농장의 경보를 **통합 모니터링** (10초마다 자동 새로고침)
- 활성 경보 수, 오늘 경보 수, 오프라인 농장 수 표시
- 농장별, 유형별, 날짜별 필터링
- 경보 수동 해소 가능

### 제어 로그 (`/admin/logs`)

- 누가, 언제, 어떤 농장에서, 무슨 명령을 내렸는지 기록
- 필터: 농장, 사용자, 명령 유형, 출처, 날짜 범위
- **CSV 다운로드** 가능 (엑셀에서 열기 가능)

---

## 8. 자주 묻는 질문

### Q: 오른쪽 상단 점이 빨간색이에요

**A:** WebSocket 연결이 끊긴 상태입니다. 3초마다 자동 재연결을 시도합니다.
- 원인 1: 서버가 꺼져 있음 → 서버 상태 확인
- 원인 2: 네트워크 문제 → 인터넷 연결 확인
- 원인 3: 일시적 장애 → 잠시 기다리면 자동 복구

### Q: 모든 센서값이 0으로 표시돼요

**A:** Node-RED가 센서 데이터를 아직 보내지 않는 상태입니다.
- RPi에서 `pm2 status` 명령으로 node-red가 online인지 확인
- Node-RED 관리 화면(`http://RPi_IP:1880/node-red`)에서 플로우 확인

### Q: 비상정지 후 복구하려면?

**A:** 하단의 **[▶ 동작]** 버튼을 클릭하면 됩니다. 시스템이 RUNNING 상태로 전환되고 자동 관수가 다시 가능해집니다.

### Q: 특정 밸브만 열고 싶어요

**A:** 하단의 **[🔧 수동동작]** 버튼을 클릭하여 수동 제어 페이지로 이동한 후, 원하는 밸브 버튼을 토글하세요.

### Q: 자동 관수 조건을 변경하고 싶어요

**A:** 헤더의 📋 (프로그램) 아이콘 → 해당 프로그램 탭 → 트리거 설정에서 변경합니다. 일사량/시간간격/고정시간 중 선택 가능합니다.

### Q: 일일 관수 실적을 확인하고 싶어요

**A:** 헤더의 📊 (일일집계) 아이콘 → 날짜 선택 → 검색. 프로그램별 관수 횟수, EC/pH 평균, 밸브별 유량을 확인할 수 있습니다.

### Q: 경보 임계값을 변경하고 싶어요

**A:** 헤더의 ⚙ (설정) 아이콘 → 환경 설정 영역에서 EC/pH/온도 상한/하한 값을 변경하고 저장합니다.

### Q: 원격에서 접속이 안 돼요

**A:** 확인 사항:
1. 사무실 서버가 실행 중인지 확인 (`docker compose ps`)
2. 접속 URL이 올바른지 확인 (`http://서버IP:80`)
3. 계정이 활성 상태인지 관리자에게 문의
4. 해당 농장에 접근 권한이 부여되어 있는지 확인

---

## 접속 정보 요약

| 항목 | 주소 |
|------|------|
| 터치패널 (RPi 직접) | `http://192.168.137.86:3001` |
| 원격 대시보드 (개발) | `http://localhost:5173` |
| Node-RED 관리 | `http://192.168.137.86:1880/node-red` |
| 기본 로컬 계정 | admin / admin1234 |
| Node-RED 계정 | admin / admin1234 |
